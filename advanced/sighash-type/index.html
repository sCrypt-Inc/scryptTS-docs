<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-advanced/sighash-type">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Sighash Types | sCrypt</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.scrypt.io/advanced/sighash-type"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Sighash Types | sCrypt"><meta data-rh="true" name="description" content="A signature hash (sighash) flag is used to indicate which part of the transaction is signed by the ECDSA signature. There are mainly two ways to use it in the context of Bitcoin smart contracts."><meta data-rh="true" property="og:description" content="A signature hash (sighash) flag is used to indicate which part of the transaction is signed by the ECDSA signature. There are mainly two ways to use it in the context of Bitcoin smart contracts."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.scrypt.io/advanced/sighash-type"><link data-rh="true" rel="alternate" href="https://docs.scrypt.io/advanced/sighash-type" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.scrypt.io/advanced/sighash-type" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://OJKYHFWNLH-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="sCrypt" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.7e29c5c9.css">
<link rel="preload" href="/assets/js/runtime~main.1b10b6fe.js" as="script">
<link rel="preload" href="/assets/js/main.fd48d3a6.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/scrypt.png" alt="scrypt Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/scrypt.png" alt="scrypt Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/sCrypt-Inc/scryptTS-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Suggest an improvement for this page<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/installation">Installation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/bitcoin-basics/">Bitcoin Basics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Bitcoin Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/how-to-write-a-contract/">How to Write a Contract</a><button aria-label="Toggle the collapsible sidebar category &#x27;How to Write a Contract&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/how-to-deploy-and-call-a-contract/">How to Deploy &amp; Call a Contract</a><button aria-label="Toggle the collapsible sidebar category &#x27;How to Deploy &amp; Call a Contract&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/how-to-test-a-contract">How to Test a Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/how-to-debug-a-contract">How to Debug a Contract</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/how-to-integrate-a-frontend/">How to Integrate With a Frontend</a><button aria-label="Toggle the collapsible sidebar category &#x27;How to Integrate With a Frontend&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/how-to-publish-a-contract">How to Publish a Contract to NPM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/how-to-verify-a-contract">How to Verify a Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ethereum-devs">sCrypt for Ethereum Developers</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/category/advanced">Advanced</a><button aria-label="Toggle the collapsible sidebar category &#x27;Advanced&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/advanced/how-to-integrate-scrypt-service">How to Integrate sCrypt Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/advanced/sighash-type">Sighash Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/advanced/how-to-debug-scriptcontext">How to Debug ScriptContext Failure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/advanced/inline-asm">Use Script inside sCrypt</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/advanced/codeseparator">Use Code Separators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/advanced/how-to-add-a-provider">How to Add a Provider</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/advanced/how-to-add-a-signer">How to Add a Signer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/advanced/how-to-call-multiple-contracts">Call Multiple Contracts in a Single Tx</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/category/tutorials">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/hello-world">Tutorial 1: Hello World</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/timeLock">Tutorial 2: Time Lock</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/auction">Tutorial 3: Auction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/oracle">Tutorial 4: Oracle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/tic-tac-toe">Tutorial 5: Tic Tac Toe</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/zkp">Tutorial 6: Zero Knowledge Proofs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/voting">Tutorial 7: Voting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/escrow">Tutorial 8: Escrow</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/faq">FAQ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/reference/">Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/advanced"><span itemprop="name">Advanced</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Sighash Types</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Sighash Types</h1><p>A signature hash (sighash) flag is used to indicate which part of the transaction is signed by the ECDSA signature. There are mainly two ways to use it in the context of Bitcoin smart contracts.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-sighash-types-in-signatures">1. Sighash Types in Signatures<a class="hash-link" href="#1-sighash-types-in-signatures" title="Direct link to heading">​</a></h2><p>In this section, we will go deep into the sighash type and introduce how to use it in the bitcoin signatures.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="digital-signature">Digital Signature<a class="hash-link" href="#digital-signature" title="Direct link to heading">​</a></h3><p>A digital signature is a mathematical scheme that consists of two parts：</p><ul><li>an algorithm for creating a signature, using a private key to sign a message.</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sign(privateKey, message) --&gt; signature</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>an algorithm that allows anyone to verify the signature, given also the message and a public key.</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">verify(signature, publicKey, message) --&gt; true/false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The private key and the public key always appear in pairs, and the public key can be calculated from the private key, but not vice versa. Thus, you will always publish the public key so anyone can verify your signature, and keep the private key safe so only you can provide the correct signature.</p><p><img loading="lazy" src="/assets/images/signing-d387f3d38cf837d7bae507c1d85aed43.png" width="506" height="515" class="img_ev3q"></p><p>Digital signatures are used to represent the authenticity and integrity of a message, since any modification to the message invalidates the signature, causing signature verification to fail. It is also proof that someone owns the private key, since the signature cannot be forged and it can be successfully verified with the corresponding public key only if it is signed with the correct private key.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bitcoin-signature">Bitcoin Signature<a class="hash-link" href="#bitcoin-signature" title="Direct link to heading">​</a></h3><p>Digital signatures are applied to messages, which in the case of bitcoin, are the transactions themselves. The signature implies a commitment by the signer to specific transaction data. In the simplest form, the signature applies to the entire transaction (excluding the unlocking scripts), thereby committing all the inputs, outputs, and other transaction fields. The P2PKH transaction is a simple example of using signatures, which is widely used in bitcoin.</p><p>Using a sighash flag, a Bitcoin signature specifies which parts of a transaction’s data is included and thus signed by a private key. The included transaction data is the so called <a href="/how-to-write-a-contract/scriptcontext">ScriptContext</a>. Every signature has a sighash flag and the flag can be different from signature to signature. </p><p>The image below illustrates what data would be signed using an <code>ALL</code> sighash flag. The data being signed is highlighted in green.</p><p><img loading="lazy" src="/assets/images/signingTx-009ab3a0b9ac47d9eb4391b08aaa86cd.png" width="976" height="810" class="img_ev3q"></p><p>There are three sighash flags: <code>ALL</code>, <code>NONE</code>, and <code>SINGLE</code>.</p><table><thead><tr><th>Sighash flag</th><th>Description</th></tr></thead><tbody><tr><td>ALL</td><td>Signature applies to all inputs and outputs</td></tr><tr><td>NONE</td><td>Signature applies to all inputs, none of the outputs</td></tr><tr><td>SINGLE</td><td>Signature applies to all inputs but only the one output with the same index number as the signed input</td></tr></tbody></table><p>In addition, there is a modifier flag <code>ANYONECANPAY</code>, which can be combined with each of the preceding flags. When <code>ANYONECANPAY</code> is set, only one input is signed, leaving the rest inputs open for modification.</p><table><thead><tr><th>Sighash flag</th><th>Description</th></tr></thead><tbody><tr><td>ALL <!-- -->|<!-- --> ANYONECANPAY</td><td>Signature applies to one input and all outputs</td></tr><tr><td>NONE <!-- -->|<!-- --> ANYONECANPAY</td><td>Signature applies to one input, none of the outputs</td></tr><tr><td>SINGLE <!-- -->|<!-- --> ANYONECANPAY</td><td>Signature applies to one input and the output with the same index number</td></tr></tbody></table><p>All the six flags can be summarized in the following diagram.</p><p><img loading="lazy" src="/assets/images/sighashtypes-8b0d4314acae2a58b674bcdf32b2e17f.png" width="1053" height="745" class="img_ev3q"></p><p>As described in the <a href="/how-to-write-a-contract/scriptcontext#sighash-type">doc</a> before, different sighash type decides which part of the spending transaction is included in <code>ScriptContext</code>. More specifically, it will affect the value of four fields: <code>hashPrevouts</code>, <code>hashSequence</code>, <code>hashOutputs</code>, and <code>sigHashType</code>.</p><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td>hashPrevouts</td><td>If the <code>ANYONECANPAY</code> modifier is not set, it&#x27;s double SHA256 of the serialization of all input outpoints. Otherwise, it&#x27;s a <code>uint256</code> of <code>0x0000......0000</code>.</td></tr><tr><td>hashSequence</td><td>If none of the <code>ANYONECANPAY</code>, <code>SINGLE</code>, <code>NONE</code> is set, it&#x27;s double SHA256 of the serialization of sequence of all inputs. Otherwise, it&#x27;s a <code>uint256</code> of <code>0x0000......0000</code>.</td></tr><tr><td>hashOutputs</td><td>If the sighash type is neither <code>SINGLE</code> nor <code>NONE</code>, it&#x27;s double SHA256 of the serialization of all outputs. If the sighash type is <code>SINGLE</code> and the input index is smaller than the number of outputs, it&#x27;s the double SHA256 of the output with the same index as the input. Otherwise, it&#x27;s a <code>uint256</code> of <code>0x0000......0000</code>.</td></tr><tr><td>sigHashType</td><td>sighash type of the signature</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases">Use Cases<a class="hash-link" href="#use-cases" title="Direct link to heading">​</a></h3><p>For a transaction signed with the default sighash <code>ALL</code>, it cannot be modified in any way. This is because the signature commits to all inputs and outputs of the transaction, if any part changes, the signature and thus the transactio becomes invalid. This is desirable in most cases, because the sender does not want others to temper with the signed transaction.</p><p>Let’s look at some examples using non-default sighash types.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="crowdfunding">Crowdfunding<a class="hash-link" href="#crowdfunding" title="Direct link to heading">​</a></h4><p>Someone attempting to raise funds can construct a transaction with a single output. The single output pays a target amount to a fundraiser. Such a transaction is obviously invalid, as it has no inputs. Others can amend it by adding an input of their own, as a donation. They sign their own input with <code>ALL|ANYONECANPAY</code> and pass the partially signed transactions to the next donor. <code>ALL</code> ensures the output and thus the target and fundraiser cannot be modified. <code>ANYONECANPAY</code> ensures anyone can pay by adding new inputs without invalidating existing donors&#x27; signatures. Each donation is a &quot;pledge&quot; which cannot be collected by the fundraiser until the entire target amount is raised.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="blank-check">Blank Check<a class="hash-link" href="#blank-check" title="Direct link to heading">​</a></h4><p>Someone attempting to write a blank check can construct a transaction with several inputs and no output, and sign all the inputs with <code>NONE</code>. The signatures only commit to inputs of the transaction. This allows anyone to add their desired outputs to the transaction to spend the funds in anyway she wants.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-generate-a-signature-with-a-specific-sighash">How to generate a signature with a specific sighash<a class="hash-link" href="#how-to-generate-a-signature-with-a-specific-sighash" title="Direct link to heading">​</a></h3><p>For those contract public methods that require one or more signatures as input parameters, we can specify different sighash types for the signatures when calling it.</p><p>Take the <a href="/how-to-deploy-and-call-a-contract/#method-with-signatures">P2PKH contract</a> as an example, it requires a single signature to <code>unlock</code>.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">method</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sig</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Sig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pubkey</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> PubKey</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Check if the passed public key belongs to the specified address.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">assert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">pubKey2Addr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pubkey</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;public key does not correspond to address&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Check signature validity.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">assert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">checkSig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pubkey</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;signature check failed&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There are two changes to specify a sighash type, which defaults to <code>ALL</code> if not specified explicitly.</p><ol><li>Pass a <code>SignatureOption</code> object to <code>pubKeyOrAddrToSign</code> to specify the sighash type.</li><li>Pass the sighash as the third parameter of <code>findSig()</code>.</li></ol><p>Let&#x27;s examine a usage example. Suppose we have the aforementioned <code>P2PKH</code> contract deployed, and we wish to call or unlock it.
However, we encounter an issue: we don&#x27;t possess sufficient funds to cover the network fees for the new contract call transaction. Fortunately, a generous friend offers to cover these fees for us.
In this scenario, we can employ the <code>ANYONECANPAY | ALL</code> flag with our signature to unlock the deployed <code>P2PKH</code> contract. This allows our friend to append another input to our transaction, contributing funds to pay the network fee.</p><p>To illustrate, we would structure the contract call as follows:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> sighashType </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SignatureHashType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">ANYONECANPAY_ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> tx </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> p2pkh</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">methods</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Pass the first parameter, the signature, to `unlock`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Once the transaction is signed, signatures are returned in `SignatureResponse[]`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Identify the required signature(s) using the public key, address, and the sighash type specified.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sigResps</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">findSig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sigResps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> publicKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sighashType</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">PubKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">toHex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">publicKey</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Direct the signer to use the private key associated with `publicKey` and the specified sighash type to sign this transaction.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pubKeyOrAddrToSign</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            pubKeyOrAddr</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> publicKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sigHashType</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> sighashType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// This flag ensures the call tx is only created locally and not broadcasted.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        partiallySigned</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Prevents automatic addition of fee inputs.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        autoPayFee</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> MethodCallOptions</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token constant" style="color:#36acaa">P2PKH</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Executing the above will yield the entire contract call transaction without broadcasting it. We can subsequently pass this transaction to our friend. Since we applied the <code>ANYONECANPAY</code> sighash flag, adding an additional input will not invalidate our signature. This is because network nodes will exclusively use the first input to authenticate our signature.</p><p>To further elaborate, we might also use the <code>ANYONECANPAY | SINGLE</code> flag. This would grant our friend the capability to append extra outputs to our transaction. This can be advantageous, for instance, if he wishes to reclaim a portion of his contributed funds as change, especially if he used an UTXO with an excessive amount of locked-in funds.</p><p>You can find a full code example in our project <a href="https://github.com/sCrypt-Inc/boilerplate/blob/master/tests/p2pkh-anyonecanpay.test.ts" target="_blank" rel="noopener noreferrer">boilerplate</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-sighash-types-in-method-parameters">2. Sighash Types in <code>@method()</code> Parameters<a class="hash-link" href="#2-sighash-types-in-method-parameters" title="Direct link to heading">​</a></h2><p>In this section, we will introduce how to specify different sighash types in the <code>@method()</code> decorator.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Sighash here only affects contracts that access <code>ScriptContext</code> in their public methods.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="counter">Counter<a class="hash-link" href="#counter" title="Direct link to heading">​</a></h3><p>Let us use the <a href="/how-to-write-a-contract/stateful-contract">Counter</a> contract as an example. It simply records how many times it has been called since deployment.</p><p>Noted that the <code>@method</code> <a href="/how-to-write-a-contract/#method-decorator">decorator</a> takes a sighash type as a parameter, whose default is <code>ALL</code>. According to the <a href="/how-to-write-a-contract/scriptcontext#sighash-type">doc</a>,  <code>hashOutputs</code> is the double SHA256 of the serialization of <strong>all outputs</strong> when the sighash type is <code>ALL</code>. The <a href="/how-to-deploy-and-call-a-contract/how-to-customize-a-contract-tx#default-1">default calling transaction builder</a> adds a change output when necessary. That&#x27;s why we need to add a change output when building outputs of the spending transaction in the public method: we need to build all the outputs that are included in <code>hashOutputs</code>. Otherwise, contract call will fail.</p><p>The following <a href="https://test.whatsonchain.com/tx/845f22b728deb23acacbc6f58f23ffde9c3e2be976e08c57f2bdcb417e3eacc5" target="_blank" rel="noopener noreferrer">transaction</a> is a contract calling transaction of <code>Counter</code>. As you can see, it contains two outputs: one for the new state, the other for change.</p><p><img loading="lazy" src="/assets/images/counter-call-d056c6e9d9055b27de5635b82f741918.png" width="2504" height="1528" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-counter">Advanced Counter<a class="hash-link" href="#advanced-counter" title="Direct link to heading">​</a></h3><p>Noted that in the state transition of <code>Counter</code>, there is always only one UTXO that contains the latest contract state. When the contract is called, it spends the UTXO of the current state and creates a UTXO of the new state. Moreover, the contract input index of the spending transaction and the contract output index are the same.</p><p>In fact, we only care about the contract-related UTXO in the transaction inputs and outputs when calling Counter, and do not care about other inputs and outputs. Thus, we can use <code>SINGLE | ANYONECANPAY</code> to simplify the contract.
<code>SINGLE</code> lets us focus on the contract output itself.
<code>ANYONECANPAY</code> allows anyone to add inputs for this contract calling transaction to, e.g., pay fees.</p><p>We make two changes to the original Counter.</p><ol><li>Using <code>@method(SigHash.ANYONECANPAY_SINGLE)</code></li><li>Build an <code>output</code> that only contains the contract&#x27;s new state, without the change output.</li></ol><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AdvancedCounter</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">SmartContract</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 1) add ANYONECANPAY_SINGLE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">method</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SigHash</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">ANYONECANPAY_SINGLE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">incrementOnChain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> amount</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> bigint </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">utxo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 2) remove change output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> output</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ByteString </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">buildStateOutput</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">assert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hashOutputs </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">hash256</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">output</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;hashOutputs mismatch&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can check the <a href="https://github.com/sCrypt-Inc/boilerplate/blob/master/src/contracts/advancedCounter.ts" target="_blank" rel="noopener noreferrer">complete code here</a>.</p><p>The following <a href="https://test.whatsonchain.com/tx/e06d86f8d8b867c503eca799bb542b5f1d1f81aa75ad00ab4377d65764bef68c" target="_blank" rel="noopener noreferrer">transaction</a> is a contract calling transaction of <code>AdvancedCounter</code>. You can see it also contains two outputs, but we only use one output when checking if it hashes to <code>hashOutputs</code> in the public method, since we use <code>SINGLE</code>.</p><p><img loading="lazy" src="/assets/images/advanced-counter-call-10d4de2cce2d5636da9d8e4b59301c28.png" width="2492" height="1526" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="more-examples">More examples<a class="hash-link" href="#more-examples" title="Direct link to heading">​</a></h3><p>Use different sighash types in <code>@method()</code> decorator will change the value of <code>ScriptContext</code>. This is useful in many cases.</p><ul><li>If your contract needs to restrict all inputs and outputs of the spending transaction, use <code>ALL</code>.</li><li>If your contract is stateful and the state is always in a single output, simplify it using <code>SINGLE</code>.</li><li>If you want to enable someone else could add inputs after the transaction is sealed, such as for paying transaction fees, apply the <code>ANYONECANPAY</code> modifier.</li></ul><p>You can find these examples in our <a href="https://github.com/sCrypt-Inc/boilerplate" target="_blank" rel="noopener noreferrer">boilerplate</a>.</p><ul><li><a href="https://github.com/sCrypt-Inc/boilerplate/blob/master/src/contracts/acs.ts" target="_blank" rel="noopener noreferrer">AnyoneCanSpend</a></li><li><a href="https://github.com/sCrypt-Inc/boilerplate/blob/master/src/contracts/clone.ts" target="_blank" rel="noopener noreferrer">Clone</a></li><li><a href="https://github.com/sCrypt-Inc/boilerplate/blob/master/src/contracts/erc20.ts" target="_blank" rel="noopener noreferrer">ERC20</a></li><li><a href="https://github.com/sCrypt-Inc/boilerplate/blob/master/src/contracts/erc721.ts" target="_blank" rel="noopener noreferrer">ERC721</a></li><li><a href="https://github.com/sCrypt-Inc/boilerplate/blob/master/src/contracts/ordinalLock.ts" target="_blank" rel="noopener noreferrer">OrdinalLock</a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/advanced/how-to-integrate-scrypt-service"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">How to Integrate sCrypt Service</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/advanced/how-to-debug-scriptcontext"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">How to Debug ScriptContext Failure</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-sighash-types-in-signatures" class="table-of-contents__link toc-highlight">1. Sighash Types in Signatures</a><ul><li><a href="#digital-signature" class="table-of-contents__link toc-highlight">Digital Signature</a></li><li><a href="#bitcoin-signature" class="table-of-contents__link toc-highlight">Bitcoin Signature</a></li><li><a href="#use-cases" class="table-of-contents__link toc-highlight">Use Cases</a></li><li><a href="#how-to-generate-a-signature-with-a-specific-sighash" class="table-of-contents__link toc-highlight">How to generate a signature with a specific sighash</a></li></ul></li><li><a href="#2-sighash-types-in-method-parameters" class="table-of-contents__link toc-highlight">2. Sighash Types in <code>@method()</code> Parameters</a><ul><li><a href="#counter" class="table-of-contents__link toc-highlight">Counter</a></li><li><a href="#advanced-counter" class="table-of-contents__link toc-highlight">Advanced Counter</a></li><li><a href="#more-examples" class="table-of-contents__link toc-highlight">More examples</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 sCrypt, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.1b10b6fe.js"></script>
<script src="/assets/js/main.fd48d3a6.js"></script>
</body>
</html>